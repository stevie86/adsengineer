<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AdsEngineer - Start Your Free Trial</title>
    <script src="https://js.stripe.com/v3/"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; color: #333; background: #f8f9fa; }
        .container { max-width: 800px; margin: 0 auto; padding: 40px 20px; }
        
        .header { text-align: center; margin-bottom: 40px; }
        .header h1 { color: #667eea; margin-bottom: 10px; }
        .header p { color: #666; }
        
        .pricing-selector { background: white; padding: 30px; border-radius: 10px; margin-bottom: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .pricing-option { padding: 20px; border: 2px solid #e9ecef; border-radius: 8px; margin: 10px 0; cursor: pointer; transition: all 0.3s ease; }
        .pricing-option:hover { border-color: #667eea; }
        .pricing-option.selected { border-color: #667eea; background: #f8f9ff; }
        .pricing-option h3 { color: #333; margin-bottom: 5px; }
        .pricing-option .price { font-size: 1.5em; font-weight: bold; color: #667eea; }
        .pricing-option .features { margin-top: 10px; font-size: 0.9em; color: #666; }
        
        .payment-form { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 500; }
        .form-group input { width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 5px; font-size: 16px; transition: border-color 0.3s ease; }
        .form-group input:focus { outline: none; border-color: #667eea; }
        
        .stripe-element { padding: 12px; border: 2px solid #e9ecef; border-radius: 5px; background: white; }
        .stripe-element.focus { border-color: #667eea; }
        .stripe-element.invalid { border-color: #dc3545; }
        
        .submit-button { width: 100%; background: #667eea; color: white; padding: 15px; border: none; border-radius: 5px; font-size: 1.1em; font-weight: bold; cursor: pointer; transition: background 0.3s ease; }
        .submit-button:hover { background: #5a6fd8; }
        .submit-button:disabled { background: #ccc; cursor: not-allowed; }
        
        .error-message { color: #dc3545; margin-top: 10px; padding: 10px; background: #f8d7da; border-radius: 5px; display: none; }
        .success-message { color: #155724; margin-top: 10px; padding: 10px; background: #d4edda; border-radius: 5px; display: none; }
        
        .loading { text-align: center; padding: 20px; }
        .loading::after { content: "..."; animation: dots 1.5s steps(4, end) infinite; }
        @keyframes dots { 0%, 20% { content: "."; } 40% { content: ".."; } 60% { content: "..."; } 80%, 100% { content: ""; } }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>Start Your AdsEngineer Free Trial</h1>
        <p>See which Google Ads keywords actually convert to sales in your WooCommerce store</p>
    </div>
    
    <div class="pricing-selector">
        <h3>Choose Your Plan</h3>
        
        <div class="pricing-option" data-tier="starter" data-price-id="price_starter_monthly">
            <h3>Starter Plan</h3>
            <div class="price">$99/month</div>
            <div class="features">
                • 1 WooCommerce store<br>
                • 10,000 tracked events/month<br>
                • Google Ads integration<br>
                • Email support
            </div>
        </div>
        
        <div class="pricing-option selected" data-tier="professional" data-price-id="price_growth_monthly">
            <h3>Professional Plan</h3>
            <div class="price">$299/month</div>
            <div class="features">
                • 5 WooCommerce stores<br>
                • 100,000 tracked events/month<br>
                • Multi-platform integration<br>
                • Priority support<br>
                • Custom analytics dashboard
            </div>
        </div>
        
        <div class="pricing-option" data-tier="enterprise" data-price-id="price_enterprise_monthly">
            <h3>Enterprise Plan</h3>
            <div class="price">$999/month</div>
            <div class="features">
                • Unlimited stores<br>
                • Unlimited tracked events<br>
                • All platform integrations<br>
                • Dedicated success manager<br>
                • Custom integrations
            </div>
        </div>
    </div>
    
    <div class="payment-form">
        <h3>Payment Information</h3>
        <p style="color: #666; margin-bottom: 20px;">14-day free trial • No credit card required • Cancel anytime</p>
        
        <form id="payment-form">
            <div class="form-group">
                <label for="email">Email Address</label>
                <input type="email" id="email" name="email" placeholder="your@email.com" required>
            </div>
            
            <div class="form-group">
                <label for="name">Full Name</label>
                <input type="text" id="name" name="name" placeholder="John Doe" required>
            </div>
            
            <div class="form-group">
                <label>Credit Card</label>
                <div id="card-element" class="stripe-element"></div>
            </div>
            
            <button type="submit" class="submit-button" id="submit-button">
                Start Free Trial
            </button>
            
            <div class="error-message" id="error-message"></div>
            <div class="success-message" id="success-message"></div>
        </form>
    </div>
</div>

<script src="https://js.stripe.com/v3/"></script>
<script>
    // Initialize Stripe
    const stripe = Stripe('pk_live_YOUR_PUBLISHABLE_KEY'); // Replace with your actual publishable key
    
    // Elements
    const elements = stripe.elements();
    const cardElement = elements.create('card', {
        style: {
            base: {
                fontSize: '16px',
                color: '#333',
                '::placeholder': { color: '#999' }
            }
        }
    });
    cardElement.mount('#card-element');
    
    // Handle pricing selection
    document.querySelectorAll('.pricing-option').forEach(option => {
        option.addEventListener('click', function() {
            document.querySelectorAll('.pricing-option').forEach(opt => opt.classList.remove('selected'));
            this.classList.add('selected');
        });
    });
    
    // Handle form submission
    const form = document.getElementById('payment-form');
    const submitButton = document.getElementById('submit-button');
    const errorMessage = document.getElementById('error-message');
    const successMessage = document.getElementById('success-message');
    
    form.addEventListener('submit', async (e) => {
        e.preventDefault();
        submitButton.disabled = true;
        submitButton.textContent = 'Processing...';
        
        try {
            // Get selected pricing
            const selectedOption = document.querySelector('.pricing-option.selected');
            const priceId = selectedOption.dataset.priceId;
            const tier = selectedOption.dataset.tier;
            const email = document.getElementById('email').value;
            const name = document.getElementById('name').value;
            
            // Create Stripe checkout session
            const response = await fetch('https://adsengineer-cloud.adsengineer.workers.dev/api/v1/billing/create-checkout', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    customer_id: 'demo_customer_' + Date.now(),
                    email: email,
                    tier: tier,
                    billing_cycle: 'monthly',
                    success_url: window.location.origin + '/success',
                    cancel_url: window.location.origin + '/cancel'
                })
            });
            
            const data = await response.json();
            
            if (data.success) {
                // Redirect to Stripe Checkout
                window.location.href = data.checkout_url;
            } else {
                throw new Error(data.error || 'Failed to create checkout session');
            }
            
        } catch (error) {
            console.error('Payment error:', error);
            errorMessage.textContent = error.message;
            errorMessage.style.display = 'block';
            submitButton.disabled = false;
            submitButton.textContent = 'Start Free Trial';
        }
    });
    
    // Handle card errors
    cardElement.on('change', function(event) {
        const displayError = document.getElementById('card-errors');
        if (event.error) {
            displayError.textContent = event.error.message;
        } else {
            displayError.textContent = '';
        }
    });
</script>

</body>
</html>